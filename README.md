# StereoVisionPretrain
## О проекте
В данном репозитори представлена реализация модели глубокого обучения, использующая предварительное обучение без учителя, для последующего 
дообучения на таких задачах как прогнозирование карт диспаритета для стерео пар и 3D object detection. Проект вдохновлен идей СroСo (https://arxiv.org/abs/2210.10716, https://arxiv.org/abs/2211.10408), где предварительное обучение стерео сопоставлению основано на том, что большая часть левого изображения маскируется, и модели требуется восстановить замаскированные области по маскированному левому и правому изображениям. Для этого модель в процессе обучения должна неявно вычислять представления глубины, и использовать правое изображение для более детального восстановления левого. Оригинальная работа использовала для этой задачи ViT трансформер в качестве энкодера, cross-attention по всем токенам левого и правого изображения и декодер, что является вычислительно затратным. Данный проект реализует вычислительно более легкую модель, использующую сверточные сети, swin transformer и cross-attention по размерности диспаритета (ширина, W), что позволяет ей работать в режиме реального времени (приблизительно 30 мс на rtx 4060Ti с 32 битной точностью). 
## Архитектура
![Архитектура модели](images/architecture.png)
Модель можно разделить на две основные части: энкодер и декодер. Энкодер состоит из сверточных слоев и блоков swin transformer. Сверточные слои понижают размеры изображения с 480х640 до 30х40, далее применяются блоки swin transformer. Декодер состоит из блока disparity cross-attention, работающего по размерности диспаритета, блоков swin transformer и сверточного блока повышения размеров изображения.  
